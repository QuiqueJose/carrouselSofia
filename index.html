<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carrusel Fotos Sof√≠a</title>

    <style>
      body {
        position: relative;
        margin: 0;
        font-family: Arial, sans-serif;
        background: transparent;
      }

      /* ===== BOT√ìN M√öSICA FLOTANTE ===== */
      .music-btn {
        position: fixed; /* üî• CLAVE */
        top: 20px;
        right: 20px;
        background: #d9a7ff;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 56px;
        height: 56px;
        font-size: 22px;
        cursor: pointer;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        z-index: 99999; /* üî• CLAVE */
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .music-btn.paused {
        opacity: 0.7;
      }

      /* ===== CARROUSEL ===== */
      .carousel {
        width: 100%;
        max-width: 900px;
        margin: 40px auto;
        overflow: hidden;
        border-radius: 20px;
      }

      .slides {
        display: flex;
        transition: transform 0.8s ease-in-out;
      }

      .slide {
        flex: 0 0 25%;
        padding: 4px;
        box-sizing: border-box;
        opacity: 0;
        transition: opacity 1s ease;
      }

      .slide.active {
        opacity: 1;
      }

      .slides img {
        width: 100%;
        height: auto;
        border-radius: 14px;
        display: block;
      }

      /* Tablet */
      @media (max-width: 900px) {
        .slide {
          flex: 0 0 calc(100% / 2);
        }
      }

      /* Mobile */
      @media (max-width: 600px) {
        .slide {
          flex: 0 0 100%;
        }
      }
    </style>
  </head>

  <body>
    <audio id="bg-music" preload="auto" loop>
      <source src="./public/audio/LaPerla.mp3" type="audio/mpeg" />
    </audio>

    <!-- üéµ BOT√ìN FLOTANTE -->
    <button class="music-btn paused" id="musicBtn">‚ñ∂ Activar m√∫sicaüéµ</button>

    <!--Carrusel -->
    <div class="carousel">
      <div class="slides" id="slides"></div>
    </div>

    <!-- JS Carrusel -->
    <script>
      // ‚ö†Ô∏è ID DE LA CARPETA DE DRIVE
      const FOLDER_ID = "1AnA6dSldcoh65jl5ns7jxipW07Duz1t6";

      // API p√∫blica de Google Drive (sin auth, solo lectura)
      const API_KEY = "AIzaSyCqzg12Q3wHh_Z_WCxLDvRo6czcou1JNGE";

      const slidesContainer = document.getElementById("slides");

      let slides = [];
      let current = 0;
      let visible = 3;

      function updateVisible() {
        if (window.innerWidth < 600) visible = 1;
        else if (window.innerWidth < 900) visible = 2;
        else visible = 3;
      }

      window.addEventListener("resize", updateVisible);
      updateVisible();

      fetch(
        `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents+and+mimeType+contains+'image/'&key=${API_KEY}&fields=files(id,name)`
      )
        .then((res) => res.json())
        .then((data) => {
          data.files.forEach((file) => {
            const div = document.createElement("div");
            div.className = "slide";

            const img = document.createElement("img");
            img.src = `https://drive.google.com/thumbnail?id=${file.id}&sz=w1200`;
            img.alt = file.name;

            div.appendChild(img);
            slidesContainer.appendChild(div);
            slides.push(div);
          });

          showSlides();
          setInterval(nextSlide, 3000);
        });

      function showSlides() {
        slides.forEach((slide) => slide.classList.remove("active"));

        for (let i = 0; i < visible; i++) {
          const index = (current + i) % slides.length;
          slides[index].classList.add("active");
        }
      }

      function nextSlide() {
        current = (current + 1) % slides.length;
        showSlides();
      }
    </script>

    <!-- JS M√∫sica -->
    <script>
      const audio = document.getElementById("bg-music");
      const btn = document.getElementById("musicBtn");

      btn.addEventListener("click", () => {
        if (audio.paused) {
          audio.play();
          btn.textContent = "‚ùö‚ùö Pausar m√∫sica";
          btn.classList.remove("paused");
        } else {
          audio.pause();
          btn.textContent = "‚ñ∂ Activar m√∫sicaüéµ";
          btn.classList.add("paused");
        }
      });
    </script>
  </body>
</html>
